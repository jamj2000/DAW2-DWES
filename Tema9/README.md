> DESARROLLO WEB EN ENTORNO SERVIDOR

# Tema 9: Desarrollo de aplicaciones Web híbridas <!-- omit in toc -->
> PWA: PROGRESSIVE WEB APP. WEB MANIFEST. SERVICE WORKER.

**[`PROYECTOS DE EJEMPLO`](proyectos)**

---
- [1. Introducción](#1-introducción)
- [2. Características de una PWA](#2-características-de-una-pwa)
- [3. Pasos a seguir](#3-pasos-a-seguir)
  - [3.1. Generar manifest.json e iconos](#31-generar-manifestjson-e-iconos)
  - [3.2. Añadir manifest.js al layout principal](#32-añadir-manifestjs-al-layout-principal)
- [4. Instalar / desinstalar PWA](#4-instalar--desinstalar-pwa)
- [5. Profundizando en las PWA](#5-profundizando-en-las-pwa)
- [6. Otras propiedades de metadata](#6-otras-propiedades-de-metadata)
- [7. Favicon](#7-favicon)
- [8. Referencias](#8-referencias)



--- 

# 1. Introducción

En este tema veremos como convertir nuestra aplicación web en una PWA.

Una [aplicación web progresiva (PWA)](https://es.wikipedia.org/wiki/Aplicaci%C3%B3n_web_progresiva) es una aplicación creada utilizando tecnologías de plataforma web, pero que proporciona una experiencia de usuario similar a la de una aplicación específica de una plataforma.

Al igual que un sitio web, una PWA puede ejecutarse en múltiples plataformas y dispositivos desde una única base de código. Al igual que una aplicación específica de una plataforma, se puede instalar en el dispositivo, puede funcionar sin conexión y en segundo plano, y puede integrarse con el dispositivo y con otras aplicaciones instaladas.

![pwa](assets/pwa.png)


# 2. Características de una PWA

Las aplicaciones web progresivas combinan las mejores características de los sitios web tradicionales y las aplicaciones específicas de la plataforma.

Las PWA tienen los beneficios de los sitios web, que incluyen:

- Las PWA se desarrollan utilizando tecnologías de plataforma web estándar, por lo que pueden ejecutarse en múltiples sistemas operativos y clases de dispositivos desde una única base de código.
- Se puede acceder a las PWA directamente desde la web.

Las PWA también tienen muchos de los beneficios de las aplicaciones específicas de la plataforma, que incluyen:

- **Se pueden instalar PWA en el dispositivo**. Esto significa:
  - La PWA se puede instalar desde la tienda de aplicaciones de la plataforma o directamente desde la web.
  - La PWA se puede instalar como una aplicación específica de la plataforma y puede personalizar el proceso de instalación.
  - Una vez instalada, la PWA obtiene un ícono de aplicación en el dispositivo, junto con aplicaciones específicas de la plataforma.
  - Una vez instalada, la PWA se puede iniciar como una aplicación independiente, en lugar de como un sitio web en un navegador.

- **Las PWA pueden funcionar en segundo plano y sin conexión**: un sitio web típico solo está activo mientras la página está cargada en el navegador. Una PWA puede:
  - Funcionar mientras el dispositivo no tenga conectividad de red.
  - Actualizar contenido en segundo plano.
  - Responder a los mensajes push del servidor.
  - Mostrar notificaciones utilizando el sistema de notificaciones del sistema operativo.
  
- **Las PWA pueden usar toda la pantalla**, en lugar de ejecutarse en la interfaz de usuario del navegador.
- Las PWA se pueden integrar en el dispositivo, registrarse como destinos y fuentes compartidos y acceder a las funciones del dispositivo.
- Las PWA se pueden distribuir en tiendas de aplicaciones, así como abiertamente a través de la web.

# 3. Pasos a seguir

A continuación se muestran los pasos a seguir para convertir nuestra aplicación web en una aplicación web progresiva.

## 3.1. Generar manifest.json e iconos

Deberemos generar un archivo `manifest.json` (también puede llamarse `manifest.webmanifest`) e iconos de varios tamaños. Para ello podemos hacer uso de alguno de los generadores de *app manifest* disponibles en la web.

![generator](assets/pwa-manifest-generator.png)

Al generador deberemos proporcinarle, además de los datos de configuración, una imagen con fondo transparente y un tamano de 512x512 píxeles. A partir de ella, el generador nos proporcionará varias imagenes de menor tamaño.

> **IMPORTANTE**: En el apartado Display es muy recomendable establecer el valor `standalone`. Esto hará que nuestra aplicación se muestre en una ventana propia, sin mostrar en ningún momento el navegador subyacente.

A continuación descargaremos los archivos a nuestro PC o portátil.

![download](assets/download-manifest.png)

Una vez descargados los archivos, los colocaremos en la carpeta **`/public`** de nuestro proyecto. 

![put into public](assets/public-manifest.png)


## 3.2. Añadir manifest.js al layout principal

Indicaremos a nuestra aplicación que haga uso del manifiesto anterior.

**`src/app/layout.js`**

```js
import '@/app/globals.css'
// otros imports

export const metadata = {
  title: 'ORM Prisma',
  description: 'Generated by create next app',
  manifest: '/manifest.json'
}
```

# 4. Instalar / desinstalar PWA

Si abrimos la aplicación con Chrome, nos apareceráen la parte derecha de la barra de direcciones  un icono para instalar la app.

![install](assets/install.png)

Una vez instalada, se nos creará un acceso directo en el escritorio. 

![installed](assets/installed.png)

También es posible instalar la aplicación en un dispositivo móvil.

![installed in mobile](assets/installed-mobile.png)

En el escritorio de PC o portátil pulsamos en los 3 puntos de la barra de título para realizar la desinstalación.

![uninstall](assets/uninstall.png)


# 5. Profundizando en las PWA

Una PWA puede proporcionar otras funcionalidades más allá de la simple instalación en un sistema anfitrión. 

Más información en el siguiente enlace:

- https://www.dosmedia.com/que-son-progressive-web-apps/


# 6. Otras propiedades de metadata

La propiedad `manifest` forma parte del objeto `metadata`. Puedes encontrar otras propiedades como [openGraph](https://nextjs.org/docs/app/api-reference/functions/generate-metadata#opengraph), [robots](https://nextjs.org/docs/app/api-reference/functions/generate-metadata#robots), ... en el siguiente enlace:

- https://nextjs.org/docs/app/api-reference/functions/generate-metadata#metadata-fields


# 7. Favicon

Independientemente de la PWA, para generar los distintos tamaños del [**`favicon.ico`**](https://es.wikipedia.org/wiki/Favicon) podemos usar la herramienta web [convertico.com](https://convertico.com/es/)

![png to ico](assets/png-ico.png)


# 8. Referencias

- [Web App Manifest Generator: simicart](https://www.simicart.com/manifest-generator.html/)
- [Web App Manifest Generator: netlify](https://manifest-gen.netlify.app/) 
- [❤️ Convertidor PNG a ICO ❤️](https://convertico.com/)
- [Web App Manifest Generator: progressier](https://progressier.com/pwa-manifest-generator) 
- [MDN PWA](https://developer.mozilla.org/en-US/docs/Web/Progressive_web_apps)
- [Web Manifest](https://developer.mozilla.org/es/docs/Web/Manifest)
- [Video - Crear PWA de forma muy sencilla](https://youtu.be/Sb0_k0gaWX0?si=178qFPPH5DzuVs2h)
- [Aplicación Demo](https://nxprisma-crud-negocio.vercel.app/)